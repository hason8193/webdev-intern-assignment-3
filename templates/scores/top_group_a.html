{% extends 'base.html' %}

{% block title %}Top Group A Students - G-Scores{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <h2 class="text-center mb-4">
                <i class="fas fa-trophy text-warning me-2"></i>Top 10 Group A Students
            </h2>
            
            <div class="alert alert-info">
                <i class="fas fa-info-circle me-2"></i>
                <strong>Group A Subjects:</strong> Mathematics (Toán), Physics (Vật Lý), and Chemistry (Hóa Học)
                <br>
                Students listed below have taken all three Group A subjects and are ranked by their total score.
            </div>
            
            {% if top_students %}
            <div class="card">
                <div class="card-header bg-warning text-dark">
                    <h5 class="mb-0">
                        <i class="fas fa-medal me-2"></i>Top Performers - Group A Combination
                    </h5>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-hover mb-0">
                            <thead class="table-dark">
                                <tr>
                                    <th class="text-center">Rank</th>
                                    <th>Registration Number</th>
                                    <th class="text-center">
                                        <i class="fas fa-calculator me-1"></i>
                                        Math
                                    </th>
                                    <th class="text-center">
                                        <i class="fas fa-atom me-1"></i>
                                        Physics
                                    </th>
                                    <th class="text-center">
                                        <i class="fas fa-flask me-1"></i>
                                        Chemistry
                                    </th>
                                    <th class="text-center">Total Score</th>
                                    <th class="text-center">Average</th>
                                    {% if top_students.0.ma_ngoai_ngu %}
                                    <th class="text-center">Foreign Language</th>
                                    {% endif %}
                                </tr>
                            </thead>
                            <tbody>
                                {% for student in top_students %}
                                <tr>
                                    <td class="text-center">
                                        {% if forloop.counter == 1 %}
                                            <i class="fas fa-crown text-warning fs-4"></i>
                                            <span class="badge bg-warning text-dark ms-1">1st</span>
                                        {% elif forloop.counter == 2 %}
                                            <i class="fas fa-medal text-secondary fs-5"></i>
                                            <span class="badge bg-secondary ms-1">2nd</span>
                                        {% elif forloop.counter == 3 %}
                                            <i class="fas fa-award text-danger fs-5"></i>
                                            <span class="badge bg-danger ms-1">3rd</span>
                                        {% else %}
                                            <span class="badge bg-primary">{{ forloop.counter }}</span>
                                        {% endif %}
                                    </td>
                                    <td>
                                        <strong class="text-primary">{{ student.sbd }}</strong>
                                    </td>
                                    <td class="text-center">
                                        <span class="badge {% if student.toan >= 8 %}bg-success{% elif student.toan >= 6 %}bg-info{% elif student.toan >= 4 %}bg-warning text-dark{% else %}bg-danger{% endif %} fs-6">
                                            {{ student.toan }}
                                        </span>
                                    </td>
                                    <td class="text-center">
                                        <span class="badge {% if student.vat_li >= 8 %}bg-success{% elif student.vat_li >= 6 %}bg-info{% elif student.vat_li >= 4 %}bg-warning text-dark{% else %}bg-danger{% endif %} fs-6">
                                            {{ student.vat_li }}
                                        </span>
                                    </td>
                                    <td class="text-center">
                                        <span class="badge {% if student.hoa_hoc >= 8 %}bg-success{% elif student.hoa_hoc >= 6 %}bg-info{% elif student.hoa_hoc >= 4 %}bg-warning text-dark{% else %}bg-danger{% endif %} fs-6">
                                            {{ student.hoa_hoc }}
                                        </span>
                                    </td>
                                    <td class="text-center">
                                        <strong class="text-primary fs-5">{{ student.group_a_total|floatformat:1 }}</strong>
                                    </td>
                                    <td class="text-center">
                                        <span class="text-muted">{{ student.get_group_a_average|floatformat:2 }}</span>
                                    </td>
                                    {% if top_students.0.ma_ngoai_ngu %}
                                    <td class="text-center">
                                        {% if student.ma_ngoai_ngu %}
                                            <span class="badge bg-light text-dark">{{ student.ma_ngoai_ngu.code }}</span>
                                        {% else %}
                                            <span class="text-muted">-</span>
                                        {% endif %}
                                    </td>
                                    {% endif %}
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Additional Statistics -->
            <div class="row mt-4">
                <div class="col-md-4">
                    <div class="card text-center">
                        <div class="card-body">
                            <i class="fas fa-trophy fa-2x text-warning mb-2"></i>
                            <h5>Highest Total</h5>
                            <p class="text-primary fs-4 mb-0">{{ top_students.0.group_a_total|floatformat:1 }}</p>
                            <small class="text-muted">SBD: {{ top_students.0.sbd }}</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card text-center">
                        <div class="card-body">
                            <i class="fas fa-chart-line fa-2x text-success mb-2"></i>
                            <h5>Top 10 Average</h5>
                            <p class="text-success fs-4 mb-0">
                                {{ average_score|floatformat:2 }}
                            </p>
                            <small class="text-muted">Group A Subjects</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card text-center">
                        <div class="card-body">
                            <i class="fas fa-graduation-cap fa-2x text-info mb-2"></i>
                            <h5>Excellence Rate</h5>
                            <p class="text-info fs-4 mb-0">
                                {{ excellent_percentage|floatformat:0 }}%
                            </p>
                            <small class="text-muted">Average ≥ 8.0</small>
                        </div>
                    </div>
                </div>
            </div>
            
            {% else %}
            <div class="alert alert-warning text-center">
                <i class="fas fa-exclamation-triangle fa-2x mb-3"></i>
                <h5>No Group A Students Found</h5>
                <p>No students found who have taken all three Group A subjects (Math, Physics, Chemistry).</p>
            </div>
            {% endif %}
            
            <!-- Navigation -->
            <div class="text-center mt-4">
                <a href="{% url 'scores:statistics' %}" class="btn btn-outline-primary me-2">
                    <i class="fas fa-chart-bar me-1"></i>View Statistics
                </a>
                <a href="{% url 'scores:lookup' %}" class="btn btn-primary">
                    <i class="fas fa-search me-1"></i>Look Up Scores
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}